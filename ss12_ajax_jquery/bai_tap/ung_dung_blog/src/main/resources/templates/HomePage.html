<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Blog List</title>
    <!--    <link rel="stylesheet" href="../static/css/myTable.css">-->
    <!--    <link rel="stylesheet" href="../static/css/bootstrap.css">-->
    <!--    <script src="../static/js/bootstrap.js"></script>-->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="../static/js/jquery-3.6.0.js"></script>
</head>
<body>
<!--<form action="search">-->
<label> search by name
    <input id="search" type="text" name="key">
</label>
<!--</form>-->

<table class="table mytable">
    <tr>
        <th> Id</th>
        <th> Title</th>
        <th> Author</th>
        <!--        <th> Category</th>-->
        <th> Price</th>
    </tr>

</table>

<button id="load">Load More</button>
</body>
<script>
    $(document).ready(function () { //hien thi danh sach blog

        $.ajax({

                url: "http://localhost:8080/blog/v1/blogList",
                type: "GET",
                dataType: "json",
                success: function (data) {

                    let tr = [];
                    for (let i = 0; i < data.length; i++) {
                        console.log(data[i].id);
                        console.log(data[i].title);
                        console.log(data[i].author);
                        tr.push('<tr>');
                        tr.push('<td>' + data[i].id + '</td>');
                        tr.push('<td>' + data[i].title + '</td>');
                        tr.push('<td>' + data[i].author + '</td>');
                        // tr.push('<td>' + data[i].cateId.cateName + '</td>');
                        tr.push('<td>' + data[i].price + '</td>');
                        tr.push('</tr>');

                    }
                    $('table').append($(tr.join('')));
                }
            }
        )
    })

    $("#search").keyup(function () {
        let value = $(this).val();
        value = value.trim();

        console.log(value);
        if (value != null || value.length > 0) {
            $('table').empty();
            $.ajax({
                    url: "http://localhost:8080/blog/v1/findBlog/" + value,
                    type: "GET",
                    dataType: "json",
                    success: function (data) {

                        let tr = [];
                        for (let i = 0; i < data.length; i++) {

                            tr.push('<tr>');
                            tr.push('<td>' + data[i].id + '</td>');
                            tr.push('<td>' + data[i].title + '</td>');
                            tr.push('<td>' + data[i].author + '</td>');
                            // tr.push('<td>' + data[i].cateId.cateName + '</td>');
                            tr.push('<td>' + data[i].price + '</td>');
                            tr.push('</tr>');
                            console.log(data[i].id)
                            console.log(data[i].title)
                            console.log(data[i].author)
                        }
                        $('table').append($(tr.join('')));
                    }
                }
            )
        }
        if (value.length === 0) {
            $.ajax({
                    url: "http://localhost:8080/blog/v1/blogList",
                    type: "GET",
                    dataType: "json",
                    success: function (data) {
                        console.log(data);
                        let tr = [];
                        for (let i = 0; i < data.length; i++) {
                            tr.push('<tr>');
                            tr.push('<td>' + data[i].id + '</td>');
                            tr.push('<td>' + data[i].title + '</td>');
                            tr.push('<td>' + data[i].author + '</td>');
                            // tr.push('<td>' + data[i].cateId.cateName + '</td>');
                            tr.push('<td>' + data[i].price + '</td>');
                            tr.push('</tr>');
                        }
                        $('table').append($(tr.join('')));
                    }
                }
            )
        }

    })

</script>
</html>